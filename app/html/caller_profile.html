<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Page Title-->
  <title>Caller Profile Page</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Our StyleSheet-->
  <link rel="stylesheet" href="/css/caller_profile.css">

  <!-- Icon libraries from https://fonts.google.com/icons -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
  <link href="https://netdna.bootstrapcdn.com/font-awesome/3.1.1/css/font-awesome.css" rel="stylesheet">

</head>

<body>
  <!-- Templates -->
  <template id="IncidentTemplate">
    <div class="posts">
      <div class="incident">
        <span id="deleteIncidentButton" class="close">&times;</span>
        <span id="incidentTitle">

        </span>
        <span id="incidentPriority">

        </span>
        <span id="incidentType">

        </span>
        <span id="incidentStatus">

        </span>
        <span id="incidentTimestamp">

        </span>
      </div>
    </div>
  </template>

  <!-- Main Container-->
  <div class="container">
    <header>
      <!-- LOGO-->
      <div id="logo">
        <a href="/html/responder_profile.html">
          <img src="/imgs/saveme.jpg" width="40" alt="logo" />
        </a>
        <h2>SaveMe</h2>
      </div>


      <!--HAMBURGER MENU FOR MOBILE-->

      <div class="hamburger-menu">
        <span><i class="material-icons">list</i></span>
      </div>

      <!-- TOP NAVIGATION -->
      <div class="nav">
        <ul>

          <li onclick="show(1)">
            <h3>Home</h3>
          </li>

          <li>
            <a href="/html/about_nav.html">About</a>
          </li>

          <li>
            <a href="/html/contact_nav.html">Contact</a>
          </li>

          <li>
            <form action="/logout" method="get">
              <input id="logout" type="submit" value="Logout" />
            </form>
          </li>

        </ul>

      </div>

    </header>


    <!-- BOTTOM NAVIGATION BAR MOBILE-->
    <div class="nav-mobile">
      <ul>

        <li onclick=show(0)>
          <span><i class="material-icons">home</i></span>
          <h3>Home</h3>
        </li>

        <li>
          <span> <i class="material-icons">info</i></span>
          <a href="/html/about_nav.html">About</a>
        </li>

        <li>
          <span><i class="material-icons">call</i></span>
          <a href="/html/contact_nav.html">Contact</a>
        </li>

        <li class="active">
          <span> <i class="material-icons">account_circle</i></span>
          <h3>Account</h3>
        </li>

        <li>
          <span> <i class="material-icons">logout</i></span>
          <form action="/logout" method="get">
            <input id="logout-bt" type="submit" value="Logout" />
          </form>
        </li>

      </ul>
    </div>

    <!-- VERTICAL ICON NAVIGATION-->
    <div class="vert-bar">
      <span> <i class="material-icons">more_vert</i></span>
    </div>

    <!-- SIDEBAR NAVIGATION -->
    <aside class="sidebar">
      <!-- SIDEBAR CLOSE WHEN ON MOBILE-->
      <h2>SaveMe<span class="close"><i class="material-icons">close</i></span></h2>

      <div class="user-side">

        <div class="user-pic">

          <img id="userPicture" width="100" src="/imgs/saveme.jpg" alt="">

        </div>
        <!-- SIDE NAVIGATION USER INFORMATION-->
        <div class="user-info">

          <span id="sessionName" class="name">John Doe</span>

          <span id="sessionEmail" class="email">JohnDoe@gmail.com</span>

          <span class="status">Online</span>

        </div>

      </div>

      <!-- SIDE NAVIGATION GENERAL-->
      <div class="side-nav">
        <h2>General</h2>
        <nav>
          <ul>
            <li class ="active" onclick="show(0)">
              <span><i class="material-icons">person_outline</i></span>
              <h3>Profile</h3>
            </li>
            <li onclick="show(1)">
              <span><i class="material-icons">speed</i></span>
              <h3>Dashboard</h3>
            </li>
            <li onclick="show(2)">
              <span><i class="material-icons">timeline</i></span>
              <h3>Incident Log</h3>
            </li>
            <li onclick="show(3)">
              <span><i class="material-icons">settings</i></span>
              <h3>Settings</h3>
            </li>
          </ul>
        </nav>
      </div>
    </aside>

    <!-- DASHBOARD TAB -->
    <div class="main">

      <!-- PROFILE TAB-->
      <section class="tabs">
        <div id="user_profile_pictue"></div>
        <h1>Profile</h1>
        <div id="user_profile_section">
          <div id="container">
            <form id="upload-images-form">
              <input id="image-upload" type="file" value="Upload Image" accept="image/png, image/gif, image/jpeg"
                multiple="multiple" />
              <input id="submitProfilePhoto" type="submit" value="Save profile image" />
            </form>
          </div>
          <br><br>
          <form>
            <img id="detail_user_picture" width="200" src="/imgs/saveme.jpg" alt="">
            <p>First Name: </p>
            <div class="edit" id="detail_user_firstN" reqired>bank</div>
            <p>Last Name: </p>
            <div class="edit" id="detail_user_lastN">name</div>
            <p>Email: </p>
            <div class="edit" id="detail_user_email">email</div>
            <p>Password: </p>
            <div class="edit" id="detail_user_password">name</div>
            <p>Age: </p>
            <div class="edit" id="detail_user_age">age</div>
            <p>Gender: </p>
            <div class="edit" id="detail_user_gender">gender</div>
            <p>Phone Number: </p>
            <div class="edit" id="detail_user_cellphone">number</div>
            <p>Role: </p>
            <div class="edit" id="detail_user_role">role</div>
            <br><br>
            <span id="editUserStatus" class="status"></span>
            <br><br>
            <button type="button" id="edit-button">Edit</button>
            <button type="button" id="end-editing">Save</button>
          </form>
        </div>
      </section>
      
      <section class="profile tabs">
        <h1>Dashboard</h1>

        <div id="profiles" class="userpost">
          <div class="posts">
            <div class="profile" id="callForHelp">
              <img class="profilePicture" src="/imgs/call.png" width="40px" alt="logo">
              <p class="ticketName">Call for help</p>
            </div>
          </div>

          <div class="posts">
            <div class="profile" id="reportIncident">
              <img class="profilePicture" src="/imgs/report.png" width="40px" alt="logo">
              <p class="ticketName">Report incident</p>
            </div>
          </div>

          <div class="posts">
            <div class="profile" id="activeIncident">
              <img class="profilePicture" src="/imgs/incident.png" width="40px" alt="logo">
              <p class="ticketName">Active incident</p>
            </div>
          </div>

        </div>
      </section>

      <!-- INCIDENT LOG TAB-->
      <section class="tabs">
        <h1>Incident Log</h1>
        <div id="incidents" class="incidentLog">

        </div>
      </section>
      <section class="tabs">
        <h1>Settings</h1>

        <p class="text">Lorem ipsum dolor, sit amet consectetur adipisicing elit.
          Quia recusandae laudantium odio!
          Iusto velit laboriosam perferendis ab!
          Aliquam ab odit animi autem cumque
          sit sint corporis quo. Voluptas, natus corporis?
          test
        </p>
      </section>
    </div>


    <!-- MODALS -->

    <!-- Call for help modal -->
    <div id="callForHelpModal" class="modal">
      <div class="report-incident-modal-content">
        <div id="modalContents">
          <h2>Report an Incident</h2>
          <div id="callcontext"> </div>
          <form>
            <!-- <label class="icon" for="email"><i class="icon-envelope "></i></label> -->
            <input type="text" name="email" id="title" placeholder="Title" />
            <br>
            <p>Incident Priority</p>
            <select id="Priority">
              <option id="urgent" value="URGENT">Urgent</option>
              <option id="high" value="HIGH">High</option>
              <option id="medium" value="MEDIUM">Medium</option>
              <option id="low" value="LOW">Low</option>
            </select>

            <p>Incident Type</p>
            <select id="InciType">
              <option id="harassment" value="HARASSMENT">Harassment</option>
              <option id="susactivity" value="SUSACTIVITY">Suspicious Activity</option>
              <option id="violence" value="VIOLENCE">Voilent Confrontation</option>
            </select>

            <div>
              <input type="text" name="name" id="description" placeholder="Description" />
            </div>

            <div>
              <p>Upload Pictures</p>
              <form id="upload-images-form-incident">
                <input id="image-upload-incident" type="file" value="Upload Image"
                  accept="image/png, image/gif, image/jpeg" multiple="multiple" />
              </form>
            </div>

            <div id="map"></div>
            <div id="UserLocation">
              <p>Your location: </p>
              <label for="userLat">Latitude: </label>
              <input name="userLat" type="text" id="user_lat">
            </div>
            <div>
              <label for="userLng">Latitude: </label>
              <input name="userLng" type="text" id="user_lng">
            </div>
            <span id="callForHelpModalStatus"></span>
            <div>
              <input type="button" class="callForHelpModalCancelButton" id="cancel" value="Cancel" />
              <input type="button" class="submitButton" id="callSubmit" value="Submit" />
            </div>
        </div>
      </div>
      </form>
    </div>
  </div>
  </div>

  <!-- Report Incident modal -->
  <div id="reportIncidentModal" class="modal">
    <div class="edit-report-modal-content">
      <div id="modalContents">
        <h2>Report incident</h2>
        <br /><br />
        <div id="reportContext"> </div>
        <br /><br />
        <form>
          <input type="button" class="reportIncidentModalCancelButton" id="cancel" value="Cancel" />
          <input type="button" class="submitButton" id="submit" value="Submit" /> //
        </form>

      </div>
    </div>
  </div>

  <!-- Active Incident modal -->
  <div id="activeIncidentModal" class="modal">
    <div class="edit-active-modal-content">
      <div id="modalContents">
        <h2>Active incident</h2>
        <br /><br />
        <div id="activeContext"> </div>
        <br /><br />
        <form>
          <input type="button" class="activeIncidentModalCancelButton" id="cancel" value="Cancel" />
          <input type="button" class="submitButton" id="submit" value="Submit" />
        </form>

      </div>
    </div>
  </div>

  <!-- Delete incident modal -->
  <div id="deleteIncidentModal" class="modal">
    <div class="delete-incident-modal-content">
      <div id="deleteIncidentContent">
        <form>
          <h2>Delete incident?</h2>
          <span id="deleteIncidentStatus" class="modalStatus"></span>
          <input type="button" class="cancelButton" id="deleteIncidentCancelButton" value="Cancel" />
          <input type="button" class="submitButton" id="deleteIncidentSubmitButton" value="Delete" />
        </form>
      </div>
    </div>
  </div>

  <!-- Display incident modal -->
  <div id="displayIncidentModal" class="modal">
    <div class="display-incident-modal-content">
      <div id="displayIncidentContent">
        <p id="displayIncidentTitle"></p>
        <p id="displayIncidentPriority"></p>
        <p id="displayIncidentType"></p>
        <p id="displayIncidentStatus"></p>
        <p id="displayIncidentCallerID"></p>
        <p id="displayIncidentDescription"></p>
        <img id="displayIncidentImage" src="" width="300" alt="Incident Picture">
        <p id="displayIncidentLat"></p>
        <p id="displayIncidentLon"></p>
        <p id="displayIncidentTimestamp"></p>
        <p id="displayIncidentResolutionComment"></p>
      </div>
      <div id="displayIncidentModalButtons">
        <form>
          <input type="button" class="cancelButton" id="displayIncidentCancelButton" value="Back" />
        </form>
      </div>
    </div>
  </div>

  </div>
  <!-- SCRIPT FOLDER-->
  <script src="/js/caller_profile_edit.js"></script>
  <script src="/js/caller_profile.js"></script>
  <script src="/js/caller_profile_upload_photo.js"></script>
  <script src="/js/caller_profile_delete_incident.js"></script>
  <script src="/js/caller_profile_display_incident.js"></script>


  <!-- JQuery-->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

  <!--DISPLAY NAVIGATION ON MOBILE-->
  <script>
    const tbtn = document.querySelectorAll(".side-nav ul li");
    const tab = document.querySelectorAll(".tabs");

    function show(panelIndex) {
      tab.forEach(function (node) {
        node.style.display = "none";
      })
      tab[panelIndex].style.display = "block";
    }

    show(0)
  </script>

  <!--DISPLAY NAVIGATION ON MOBILE-->
  <script>
    $(".side-nav ul li").click(function () {
      $(this).addClass("active").siblings().removeClass("active");
    })
  </script>

  <!--DISPLAY NAVIGATION ON MOBILE-->
  <script>
    const hMenu = document.querySelector(".hamburger-menu");

    const navM = document.querySelector(".nav-mobile");

    hMenu.addEventListener("click", (nav) => {

      navM.classList.toggle("show");
    })
  </script>

  <!--DISPLAY NAVIGATION ON MOBILE-->
  <script>
    const Vbar = document.querySelector(".vert-bar");

    const aside = document.querySelector(".sidebar");

    const close = document.querySelector(".close");

    Vbar.addEventListener("click", () => {
      aside.classList.add("show");
    })

    close.addEventListener("click", () => {
      aside.classList.remove("show");
    })
  </script>

  <!--Easter Egg, change font-->
  <script>
    let counter = 0;

    const logo = document.getElementById("logo");
    const selectbody = document.getElementsByTagName("body")[0];


    logo.addEventListener('click', toggleFont);


    function toggleFont() {
      counter += 1;

      if (counter == 5) {
        selectbody.style.fontFamily = "monospace";
      }

    }
  </script>

  <script>
    // Note: This example requires that you consent to location sharing when
    // prompted by your browser. If you see the error "The Geolocation service
    // failed.", it means you probably did not give permission for the browser to
    // locate you.
    let map, infoWindow;

    function initMap() {
      map = new google.maps.Map(document.getElementById("map"), {
        center: {
          lat: 49.2827,
          lng: -123.1207
        },
        zoom: 11,
      });
      infoWindow = new google.maps.InfoWindow();

      const locationButton = document.createElement("input");
      locationButton.type = "button";
      locationButton.value = "Get Location";
      locationButton.id = "test"

      locationButton.classList.add("custom-map-control-button");
      map.controls[google.maps.ControlPosition.TOP_CENTER].push(locationButton);
      locationButton.addEventListener("click", () => {
        // Try HTML5 geolocation.
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(
            (position) => {
              const pos = {
                lat: position.coords.latitude,
                lng: position.coords.longitude,
              };

              console.log(pos);

              infoWindow.setPosition(pos);
              infoWindow.setContent(
                "Incident occured. Your location has been shared to our responders. The closest responder to you will be there."
              );
              infoWindow.open(map);

              document.getElementById("user_lat").value = pos.lat;
              document.getElementById("user_lng").value = pos.lng;
              map.setCenter(pos);
            },
            () => {
              handleLocationError(true, infoWindow, map.getCenter());
            }
          );
        } else {
          // Browser doesn't support Geolocation
          handleLocationError(false, infoWindow, map.getCenter());
        }
      });
    }

    function handleLocationError(browserHasGeolocation, infoWindow, pos) {
      infoWindow.setPosition(pos);
      infoWindow.setContent(
        browserHasGeolocation ?
          "Error: The Geolocation service failed." :
          "Error: Your browser doesn't support geolocation."
      );
      infoWindow.open(map);
    }

    window.initMap = initMap;
  </script>
  <script async
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDhdF0gCXSvOcoKp4tIfwQmDytBQo8SWf8&callback=initMap">
    </script>


</body>

</html>